{{!-- Include Mobile Navbar --}}
{{> theme_boost/navbar_mobile }}

{{#top_header}}
    <div class="top-header-area bg-color-0f6c76">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="header-left-content">
                        <p>{{{top_header_content}}}</p>
                    </div>
                </div>

                {{#top_header_right_content}}
                    <div class="col-lg-4">
                        <ul class="header-right-content">
                            {{{top_header_right_content}}}
                        </ul>
                    </div>
                {{/top_header_right_content}}
            </div>
        </div>
    </div>
 {{/top_header}}

<!-- Error message for language switching -->
{{#error}}
    {{#error.invalidlanguage}}
        <div class="alert alert-danger" style="margin: 10px; padding: 10px; background: rgba(220, 53, 69, 0.1); border: 1px solid rgba(220, 53, 69, 0.3); border-radius: 8px; color: #721c24;">
            <strong>خطأ في تغيير اللغة:</strong> اللغة المحددة غير صحيحة. يرجى المحاولة مرة أخرى.
        </div>
    {{/error.invalidlanguage}}
{{/error}}

<!-- Alternative error handling for URL parameters -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Check for error in URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    
    if (error === 'invalidlanguage') {
        // Create and display error message
        const errorDiv = document.createElement('div');
        errorDiv.className = 'alert alert-danger';
        errorDiv.style.cssText = 'margin: 10px; padding: 10px; background: rgba(220, 53, 69, 0.1); border: 1px solid rgba(220, 53, 69, 0.3); border-radius: 8px; color: #721c24; position: fixed; top: 60px; left: 50%; transform: translateX(-50%); z-index: 9999;';
        errorDiv.innerHTML = '<strong>خطأ في تغيير اللغة:</strong> اللغة المحددة غير صحيحة. يرجى المحاولة مرة أخرى.<br><small>Error: invalidlanguage</small>';
        
        // Add close button
        const closeBtn = document.createElement('button');
        closeBtn.innerHTML = '×';
        closeBtn.style.cssText = 'float: right; font-weight: bold; font-size: 20px; line-height: 1; color: #721c24; background: none; border: none; cursor: pointer; margin-left: 10px;';
        closeBtn.onclick = function() { errorDiv.remove(); };
        errorDiv.appendChild(closeBtn);
        
        document.body.appendChild(errorDiv);
        
        // Auto-remove after 5 seconds
        setTimeout(() => {
            if (errorDiv.parentNode) {
                errorDiv.remove();
            }
        }, 5000);
        
        // Remove error from URL
        urlParams.delete('error');
        const newUrl = window.location.pathname + (urlParams.toString() ? '?' + urlParams.toString() : '');
        window.history.replaceState({}, '', newUrl);
    }
    
    // Language detection is handled in the main script
});
</script>

<header class="HEADER-0" id="navbar-header">
    <div class="DIV-0">
      <div class="DIV-1"></div>
      <div class="DIV-2"></div>
      <div class="DIV-3"></div>
      <div class="DIV-4"></div>
                    </div>
    <div class="DIV-5">
      <div class="DIV-6">
        <div class="DIV-7">
                {{#logo_visibility}}
                        {{#main_logo}}
              <img src="{{main_logo}}" alt="{{sitename}}" class="svg-0" {{#logo_styles}} style="{{{logo_styles}}}" {{/logo_styles}}>
                        {{/main_logo}}
                        {{^ main_logo }}
              <img src="{{{ config.wwwroot }}}/blocks/logo.svg" alt="{{sitename}}" class="svg-0">
                        {{/main_logo}}
                {{/logo_visibility}}
          <div class="DIV-8"><div class="DIV-9"></div></div>
                    </div>

        <!-- Custom Menu Integration -->
        <nav class="NAV-0">
          <!-- Always show navigation items -->
          <ul class="nav-items">
            <li><a href="{{{ config.wwwroot }}}/" class="nav-link">الرئيسية</a></li>
            <li><a href="{{{ config.wwwroot }}}/course/" class="nav-link">الدورات</a></li>
            <li><a href="{{{ config.wwwroot }}}/about/" class="nav-link">من نحن</a></li>
            <li><a href="{{{ config.wwwroot }}}/contact/" class="nav-link">اتصل بنا</a></li>
                    </ul>

          <!-- Show custom menu if available (as additional items) - but filter out language content -->
          {{#output.custom_menu}}
            <div class="custom-menu-additional" id="custom-menu-filtered">
              {{{ output.custom_menu }}}
            </div>
          {{/output.custom_menu}}
        </nav>
        
        <div class="DIV-10">
          <!-- Search Icon -->
         
          
          <!-- Edit Switch Integration -->
          {{{ output.edit_switch }}}
          
          <!-- Moodle User Menu Integration -->
           <div class="search-icon" id="search-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="svg-1"
            >
              <circle cx="11" cy="11" r="8" class="circle-0"></circle>
              <path d="m21 21-4.3-4.3" class="path-2"></path>
            </svg>
          </div>
          <div class="DIV-11">
            {{#usermenu}}
              <div class="custom-user-menu">
                {{> core/user_menu }}
              </div>
            {{/usermenu}}
            {{^usermenu}}
              <!-- Fallback for when usermenu is not available -->
              <div class="DIV-12" id="user-menu-toggle" role="button" data-toggle="dropdown" aria-label="User menu" aria-haspopup="true" aria-controls="user-action-menu">
                <div class="DIV-13">
                  {{#isloggedin}}
                    {{#userpicture}}
                      <img
                        src="{{userpicture}}"
                        alt="Profile"
                        class="IMG-0"
                      />
                    {{/userpicture}}
                    {{^userpicture}}
                      <div style="width: 100%; height: 100%; background-color: rgb(16, 82, 162); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1rem;">
                        {{#userfirstname}}{{userfirstname}}{{/userfirstname}}{{#userlastname}}{{userlastname}}{{/userlastname}}
                        {{^userfirstname}}
                          {{#userfullname}}
                            {{userfullname}}
                          {{/userfullname}}
                          {{^userfullname}}
                            <span data-ar="سعود محمد" data-en="Saud Mohammed">سعود محمد</span>
                          {{/userfullname}}
                        {{/userfirstname}}
                      </div>
                    {{/userpicture}}
                    {{/isloggedin}}
                  {{^isloggedin}}
                    <div style="width: 100%; height: 100%; background-color: rgb(16, 82, 162); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1rem;">
                      {{#userfirstname}}{{userfirstname}}{{/userfirstname}}{{#userlastname}}{{userlastname}}{{/userlastname}}
                      {{^userfirstname}}
                        AU
                      {{/userfirstname}}
                    </div>
                    {{/isloggedin}}
                </div>
                <span class="SPAN-0" id="user-fullname-display">
                  <!-- Debug: isloggedin = {{isloggedin}} -->
                  <!-- Debug: userfullname = {{userfullname}} -->
                  <!-- Debug: userfirstname = {{userfirstname}} -->
                  <!-- Debug: userlastname = {{userlastname}} -->
                  {{#isloggedin}}
                    {{#userfullname}}
                      {{userfullname}}
                    {{/userfullname}}
                    {{^userfullname}}
                      {{#userfirstname}}{{userfirstname}}{{/userfirstname}}{{#userlastname}} {{userlastname}}{{/userlastname}}
                      {{^userfirstname}}
                        <span data-ar="سعود محمد" data-en="Saud Mohammed">سعود محمد</span>
                      {{/userfirstname}}
                    {{/userfullname}}
                  {{/isloggedin}}
                  {{^isloggedin}}
                    <span data-ar="معلم" data-en="Teacher">Teacher</span>
                  {{/isloggedin}}
                </span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="svg-2"
                >
                  <path d="m6 9 6 6 6-6" class="path-3"></path>
                </svg>
        </div>
            {{/usermenu}}
    </div>

          <!-- Moodle Language Menu Integration -->
          <div class="DIV-14">
            {{#langmenu}}
              {{> theme_boost/language_menu }}
            {{/langmenu}}
            {{^langmenu}}
              <!-- Fallback language menu with proper Moodle language switching -->
              <div class="langmenu">
                <div class="dropdown show">
                  <a href="#" role="button" id="lang-menu-toggle" data-toggle="dropdown" aria-label="Language" aria-haspopup="true" aria-controls="lang-action-menu" class="btn dropdown-toggle">
                    <i class="icon fa fa-language fa-fw me-1" aria-hidden="true"></i>
                    <span class="langbutton" id="current-lang-display">English (en)</span>
                    <b class="caret"></b>
                  </a>
                  <div role="menu" aria-labelledby="lang-menu-toggle" id="lang-action-menu" class="dropdown-menu dropdown-menu-right">
                    <a href="{{{ config.wwwroot }}}/theme/edma/langswitch.php?lang=en" class="dropdown-item ps-5" role="menuitem">English (en)</a>
                    <a href="{{{ config.wwwroot }}}/theme/edma/langswitch.php?lang=ar" class="dropdown-item ps-5" role="menuitem">العربية (ar)</a>
                  </div>
                </div>
              </div>
            {{/langmenu}}
          </div>
          
          <!-- Login/Signup Buttons for Guests -->
          {{^isloggedin}}
                                {{#header_btn_text}}
              <div class="auth-buttons">
                                    {{#header_left_btn_text}}
                  <a href="{{#header_left_btn_url}}{{header_left_btn_url}}{{/header_left_btn_url}}{{^header_left_btn_url}}{{login_url}}{{/header_left_btn_url}}" class="login-btn">
                                                {{header_left_btn_text}}
                                            </a>
                                    {{/header_left_btn_text}}

                <a href="{{#header_btn_url}}{{header_btn_url}}{{/header_btn_url}}{{^header_btn_url}}{{signup_url}}{{/header_btn_url}}" class="signup-btn">
                                            <i class="{{header_btn_icon}}"></i>
                  {{header_btn_text}}
                                        </a>
              </div>
                                {{/header_btn_text}}
                            {{/isloggedin}}
                    </div>
                </div>
            </div>
  </header>
  
  <!-- Hidden Moodle Menus - Will be triggered by our custom buttons -->
  <div style="display: none;">
    {{#usermenu}}
      {{{ output.user_menu }}}
    {{/usermenu}}
</div>

  <style>
  /* Mobile navbar spacing */
  @media (max-width: 768px) {
      body {
          padding-top: 80px; /* Space for mobile navbar */
      }
      
      .HEADER-0 {
          display: none; /* Hide desktop navbar on mobile */
      }
  }

  @media (min-width: 769px) {
      .mobile-navbar {
          display: none !important; /* Hide mobile navbar on desktop */
      }
  }

  .HEADER-0 {
        color: rgb(2, 8, 23);direction: rtl;background: transparent;position: fixed;top: 0px;z-index: 50;width: 100%;box-sizing: border-box;
        
  }
  
  .HEADER-0.ltr {
        direction: ltr;
  }
  
  .DIV-0 {
        position: absolute;inset: 0px;box-sizing: border-box;
        
  }
  
  .DIV-1 {
        position: absolute;inset: 0px;background: rgba(255, 255, 255, 0.81);border-radius: 0 0 16px 16px;box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);backdrop-filter: blur(5px);-webkit-backdrop-filter: blur(5px);border: 1px solid rgba(255, 255, 255, 0.3);box-sizing: border-box;
        
  }
  
  .DIV-2 {
        position: absolute;inset: 0px;box-sizing: border-box;
        
  }
  
  .DIV-3 {
        position: absolute;inset: 0px;box-sizing: border-box;
        
  }
  
  .DIV-4 {
        position: absolute;inset: 0px;box-sizing: border-box;
        
  }
  
  .DIV-5 {
        margin-right: 90px;margin-left: 90px;padding: 1.25rem 2.5rem;position: relative;z-index: 10;box-sizing: border-box;
        max-width: none;
       
        
  }
  
  .DIV-6 {
        display: flex;align-items: center;justify-content: space-between;box-sizing: border-box;
        gap: 3rem;
        min-width: 0;
        width: 100%;
        
  }
  
  .DIV-7 {
        display: flex;align-items: center;gap: 2rem;box-sizing: border-box;
   
        min-width: 0;
        max-width: none;
        
  }
  
  .svg-0 {
        height: 4rem;width: 2.5rem;fill: currentcolor;color: rgb(16, 82, 162);display: block;vertical-align: middle;box-sizing: border-box;
        
  }
  
  .path-0 {
        box-sizing: border-box;
        
  }
  
  .path-1 {
        box-sizing: border-box;
        
  }
  
  .DIV-8 {
        display: flex;align-items: center;gap: 1rem;box-sizing: border-box;
        
  }
  
  .DIV-9 {
        text-align: right;box-sizing: border-box;
        
  }
  
  .NAV-0 {
        display: flex;align-items: center;gap: 2.5rem;box-sizing: border-box;
        margin: 0 3rem;
        flex: 1;
        justify-content: flex-end;
        position: relative;
        z-index: 20;
        flex-wrap: nowrap;
        overflow: visible;
        min-width: 0;
        max-width: none;
        width: 100%;
        @media (max-width: 1024px) {
          gap: 2rem;
          margin: 0 2rem;
        }
        @media (max-width: 768px) {
          gap: 1.5rem;
          margin: 0 1.5rem;
          flex-wrap: nowrap;
          justify-content: space-between;
          overflow: visible;
        }
        @media (max-width: 640px) {
          gap: 1rem;
          margin: 0 1rem;
        }
        
  }
  
  .NAV-0 ul {
        display: flex;align-items: center;gap: 0px;list-style: none;margin: 0;padding: 0;
        flex-wrap: nowrap;
        white-space: nowrap;
        justify-content: start;
        
  }
  
  .NAV-0 a {
        font-size: 1.1rem;line-height: 1.6;font-weight: 600;color: rgb(16, 82, 162);transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);text-decoration: none;padding: 1rem 1.75rem;border-radius: 1.25rem;background: rgba(255, 255, 255, 0.75);border: 1px solid rgba(255, 255, 255, 0.8);white-space: nowrap;flex-shrink: 0;min-width: fit-content;letter-spacing: 0.025em;
        @media (max-width: 768px) {
          font-size: 1rem;
          padding: 0.875rem 1.5rem;
          white-space: nowrap;
        }
        &:hover {
    color: rgb(16, 82, 162);
    background: rgba(255, 255, 255, 0.9);
    border-color: rgba(255, 255, 255, 1);
    transform: translateY(-2px);
    }
  
  }
  
  .nav-items {
        display: flex;align-items: center;gap: 2.5rem;list-style: none;margin: 0;padding: 0;
        flex-wrap: nowrap;
        white-space: nowrap;
        width: 100%;
        justify-content: flex-end;
        @media (max-width: 768px) {
          gap: 2rem;
          flex-wrap: nowrap;
          justify-content: space-between;
        }
        
  }
  
  .nav-items li {
        margin: 0;
        flex-shrink: 0;
        white-space: nowrap;
        min-width: fit-content;
        
  }
  
  .nav-items .nav-link {
        font-size: 1rem;line-height: 1.6;font-weight: 600;color: rgb(16, 82, 162);transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);text-decoration: none;padding: 0px 15px;border-radius: 1.25rem;background: transparent;border: 0px solid rgba(255, 255, 255, 0.8);white-space: nowrap;flex-shrink: 0;min-width: fit-content;letter-spacing: 0.025em; background-color: #fff00;
        @media (max-width: 768px) {
          font-size: 1rem;
          padding: 0px 15px;
          white-space: nowrap;
        }
        &:hover {
    color: rgb(16, 82, 162);
    background: rgba(255, 255, 255, 0.9);
    border-color: rgba(255, 255, 255, 1);
    transform: translateY(-2px);
    }
  
  }
  
  .DIV-10 {
        display: flex;align-items: center;gap: 1.5rem;box-sizing: border-box;
        flex-shrink: 0;
        min-width: fit-content;
        
  }
  
  .search-icon {
        display: flex;align-items: center;justify-content: center;width: 3rem;height: 3rem;border-radius: 1.25rem;background: transparent;backdrop-filter: blur(20px);-webkit-backdrop-filter: blur(20px);border: 0px solid rgba(255, 255, 255, 0.8);cursor: pointer;transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        &:hover {
    background: rgba(255, 255, 255, 0.9);
    transform: translateY(-2px);
    }
  
  }
  
  .auth-buttons {
        display: flex;align-items: center;gap: 1rem;
        
  }
  
  .login-btn {
        background: rgba(255, 255, 255, 0.6);color: rgb(16, 82, 162);padding: 0.5rem 1rem;border-radius: 0.5rem;text-decoration: none;font-weight: 500;backdrop-filter: blur(5px);-webkit-backdrop-filter: blur(5px);border: 1px solid rgba(255, 255, 255, 0.7);transition: all 0.3s ease;
        &:hover {
    background: rgba(255, 255, 255, 0.8);color: rgb(16, 82, 162);
    }
  
  }
  
  .signup-btn {
        background: rgb(16, 82, 162);color: white;padding: 0.5rem 1rem;border-radius: 0.5rem;text-decoration: none;font-weight: 500;transition: all 0.3s ease;
        &:hover {
    background: rgb(97, 239, 255);color: rgb(16, 82, 162);
    }
  
  }
  
  .svg-1 {
        height: 1.25rem;width: 1.25rem;cursor: pointer;color: rgb(16, 82, 162);display: block;vertical-align: middle;box-sizing: border-box;opacity: 0.8;
        
  }
  
  .circle-0 {
        box-sizing: border-box;
        
  }
  
  .path-2 {
        box-sizing: border-box;
        
  }
  
  .DIV-11 {
        position: relative;box-sizing: border-box;
        
  }
  
  .custom-user-menu {
        position: relative;
        
  }
  
  .custom-user-menu .usermenu {
        margin: 0;
        
  }
  
  .custom-user-menu .dropdown-toggle {
        display: flex;cursor: pointer;align-items: center;gap: 0.5rem;border-radius: 0.75rem;background: rgba(255, 255, 255, 0.7);backdrop-filter: blur(10px);-webkit-backdrop-filter: blur(10px);padding: 0.75rem 1rem;box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.1);border: 1px solid rgba(255, 255, 255, 0.8);transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);transition-duration: 150ms;box-sizing: border-box;text-decoration: none;color: rgb(16, 82, 162);
        &:hover {
    background: rgba(255, 255, 255, 0.9);color: rgb(16, 82, 162);
    }
  
  }
  
  .custom-user-menu .userbutton {
        display: flex;align-items: center;;
        
  }
  
  .custom-user-menu .avatars {
        display: flex;align-items: center;
        
  }
  
  .custom-user-menu .avatar {
        height: 2.5rem;width: 2.5rem;overflow: hidden;border-radius: 0.75rem;background: rgba(255, 255, 255, 0.8);backdrop-filter: blur(5px);-webkit-backdrop-filter: blur(5px);box-sizing: border-box;display: flex;align-items: center;justify-content: center;
        
  }
  
  .custom-user-menu .avatar img {
        height: 100%;width: 100%;object-fit: cover;border-radius: 0.75rem;
        
  }
  
  .custom-user-menu .usertext {
        display: none;font-weight: 500;color: rgb(16, 82, 162);box-sizing: border-box;
        @media (min-width: 768px) {
          display: flex;
          }
        
  }
  
  .custom-user-menu .dropdown-menu {
        background: rgba(255, 255, 255, 0.95);backdrop-filter: blur(20px);-webkit-backdrop-filter: blur(20px);border: 1px solid rgba(255, 255, 255, 0.3);border-radius: 0.75rem;box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);margin-top: 0.5rem;
        
  }
  
  .custom-user-menu .dropdown-item {
        color: rgb(16, 82, 162);transition: all 0.3s ease;
        &:hover {
    background: rgba(16, 82, 162, 0.1);color: rgb(16, 82, 162);
    }
  
  }
  
  /* Moodle's default language menu styling */
  .langmenu {
        position: relative;
        z-index: 15;
        
  }
  
  .langmenu .dropdown-toggle {

        border-radius: 1.25rem;
        color: rgb(16, 82, 162);
        font-weight: 600;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        
  }
  
  .langmenu .dropdown-toggle:hover {
        background: rgba(255, 255, 255, 0.9);
        transform: translateY(-2px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        
  }
  
  .langmenu .dropdown-menu {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 0.75rem;
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
        margin-top: 0.5rem;
        
  }
  
  .langmenu .dropdown-item {
        color: rgb(16, 82, 162);
        transition: all 0.3s ease;
        
  }
  
  .langmenu .dropdown-item:hover {
        background: rgba(16, 82, 162, 0.1);
        color: rgb(16, 82, 162);
        
  }
  
  .DIV-12 {
        display: flex;cursor: pointer;align-items: center;gap: 1rem;border-radius: 1.25rem;background: rgba(255, 255, 255, 0.75);backdrop-filter: blur(20px);-webkit-backdrop-filter: blur(20px);padding: 1rem 1.5rem;box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);border: 1px solid rgba(255, 255, 255, 0.8);transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);box-sizing: border-box;
        &:hover {
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    transform: translateY(-2px);
    }
  
  }
  
  .DIV-13 {
        height: 2.75rem;width: 2.75rem;overflow: hidden;border-radius: 50%;background: rgba(255, 255, 255, 0.9);backdrop-filter: blur(15px);-webkit-backdrop-filter: blur(15px);box-sizing: border-box;display: flex;align-items: center;justify-content: center;border: 2px solid rgba(255, 255, 255, 0.9);
        
  }
  
  .IMG-0 {
        height: 100%;width: 100%;object-fit: cover;display: block;vertical-align: middle;max-width: 100%;box-sizing: border-box;border-radius: 50%;
        
  }
  
  .SPAN-0 {
        display: none;font-weight: 600;color: rgb(16, 82, 162);box-sizing: border-box;font-size: 1rem;letter-spacing: 0.025em;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;max-width: 150px;
        @media (min-width: 768px) {
          display: block;
          }
        
  }
  
  .svg-2 {
        height: 1.25rem;width: 1.25rem;color: rgb(16, 82, 162);transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);display: block;vertical-align: middle;box-sizing: border-box;opacity: 0.7;
        
  }
  
  .path-3 {
        box-sizing: border-box;
        
  }
  
  .DIV-14 {
        position: relative;box-sizing: border-box;
        
  }
  
  .DIV-15 {
        display: flex;cursor: pointer;align-items: center;gap: 0.5rem;border-radius: 0.5rem;background: rgba(255, 255, 255, 0.6);backdrop-filter: blur(5px);-webkit-backdrop-filter: blur(5px);padding: 0.5rem 0.75rem;border: 1px solid rgba(255, 255, 255, 0.7);transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);transition-duration: 150ms;box-sizing: border-box;
        &:hover {
    background: rgba(255, 255, 255, 0.8);
    }
  
  }
  
  .svg-3 {
        height: 1rem;width: 1rem;color: rgb(16, 82, 162);display: block;vertical-align: middle;box-sizing: border-box;
        
  }
  
  .circle-1 {
        box-sizing: border-box;
        
  }
  
  .path-4 {
        box-sizing: border-box;
        
  }
  
  .path-5 {
        box-sizing: border-box;
        
  }
  
  .SPAN-1 {
        font-size: 0.875rem;line-height: 1.25rem;font-weight: 500;color: rgb(16, 82, 162);box-sizing: border-box;
        
  }
  
  .svg-4 {
        height: 0.75rem;width: 0.75rem;color: rgb(16, 82, 162);transition-property: transform;transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);transition-duration: 150ms;display: block;vertical-align: middle;box-sizing: border-box;
        
  }
  
  .path-6 {
        box-sizing: border-box;
        
  }
  
  .custom-menu-additional {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-left: 1rem;
        
  }
  
  .custom-menu-additional a {
        font-size: 1rem;
        line-height: 1.5rem;
        font-weight: 500;
        color: rgb(16, 82, 162);
        text-decoration: none;
        padding: 0.4rem 0.8rem;
        border-radius: 0.4rem;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
        
  }
  
  .custom-menu-additional a:hover {
        color: rgb(97, 239, 255);
        background: rgba(255, 255, 255, 0.3);
        border-color: rgba(255, 255, 255, 0.4);
        
  }
  
  
  </style>

<script>


document.addEventListener('DOMContentLoaded', function() {
    // Filter out language-related content from custom menu
    const customMenuFiltered = document.getElementById('custom-menu-filtered');
    if (customMenuFiltered) {
        // Remove any elements that contain language-related text
        const languageElements = customMenuFiltered.querySelectorAll('*');
        languageElements.forEach(element => {
            const text = element.textContent || '';
            if (text.includes('English') || text.includes('العربية') || text.includes('lang') || 
                text.includes('language') || element.classList.contains('langmenu') || 
                element.classList.contains('language-menu')) {
                element.style.display = 'none';
            }
        });
    }
    
    // Search icon click handler
    const searchIcon = document.getElementById('search-icon');
    
    // Search icon click handler
    if (searchIcon) {
        searchIcon.addEventListener('click', function() {
            // Trigger Moodle's search functionality
            const moodleSearch = document.querySelector('[data-region="search-input"]');
            if (moodleSearch) {
                moodleSearch.focus();
            } else {
                // Fallback: redirect to search page
                window.location.href = '{{{ config.wwwroot }}}/search/index.php';
            }
        });
    }
    
    // User menu trigger handler
    const userMenuToggle = document.getElementById('user-menu-toggle');
    if (userMenuToggle) {
        userMenuToggle.addEventListener('click', function() {
            // Trigger Moodle's user menu
            const moodleUserMenu = document.querySelector('[data-region="user-menu"]');
            if (moodleUserMenu) {
                const dropdownToggle = moodleUserMenu.querySelector('[data-bs-toggle="dropdown"]');
                if (dropdownToggle) {
                    dropdownToggle.click();
                }
            }
        });
    }
    
    // Add smooth transition for direction changes
    const navbarHeader = document.getElementById('navbar-header');
    if (navbarHeader) {
        navbarHeader.style.transition = 'direction 0.3s ease';
    }
    
    // Update navbar direction based on current language
    function updateNavbarDirection() {
        const currentLang = document.documentElement.lang || 'ar';
        if (navbarHeader) {
            if (currentLang === 'ar') {
                navbarHeader.style.direction = 'rtl';
                navbarHeader.classList.remove('ltr');
            } else {
                navbarHeader.style.direction = 'ltr';
                navbarHeader.classList.add('ltr');
            }
        }
    }
    
    // Update direction on page load
    updateNavbarDirection();
    
    // Update current language display
    function updateCurrentLanguageDisplay() {
        const currentLangDisplay = document.getElementById('current-lang-display');
        if (currentLangDisplay) {
            // Get current language from document or URL parameters
            let currentLang = document.documentElement.lang || 'ar';
            
            // Check URL parameters for language
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            const urlForceLang = urlParams.get('forcelang');
            
            if (urlForceLang && ['ar', 'en'].includes(urlForceLang)) {
                currentLang = urlForceLang;
            } else if (urlLang && ['ar', 'en'].includes(urlLang)) {
                currentLang = urlLang;
            }
            
            if (currentLang === 'ar') {
                currentLangDisplay.textContent = 'العربية (ar)';
            } else {
                currentLangDisplay.textContent = 'English (en)';
            }
        }
    }
    
    // Update language display on page load
    updateCurrentLanguageDisplay();
    
    // Update user fullname display
    function updateUserFullnameDisplay() {
        const userFullnameDisplay = document.getElementById('user-fullname-display');
        if (userFullnameDisplay) {
            // The name should already be set by the template, but we can enhance it here if needed
            const currentLang = document.documentElement.lang || 'ar';
            const nameElements = userFullnameDisplay.querySelectorAll('[data-ar][data-en]');
            nameElements.forEach(element => {
                if (currentLang === 'ar') {
                    element.textContent = element.getAttribute('data-ar');
                } else {
                    element.textContent = element.getAttribute('data-en');
                }
            });
        }
    }
    
    // Update user name display on page load
    updateUserFullnameDisplay();
    
    // Listen for language changes from Moodle's system
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'lang') {
                updateNavbarDirection();
            }
        });
    });
    
    // Start observing
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['lang']
    });
});
</script>